<html>
<head><title>sample sessions</title>
<style 
type="text/css"> <!-- 
tt { font-family: 1em Courier, Fixed, monospace; 
     font-size: 120%;
     font-weight: bold } 
code { display: block;
       font: 1em Courier, Fixed, monospace;
       font-size: 100%;
       color: #000;
       overflow: auto;
       text-align: left;
       border: 1px solid #5581C0;
       padding: 3px 18px 3px 30px;
       margin: 1em 0 1em 0;
       line-height: 18px;
       font-weight: normal!important;
}
user { font-weight: bold }
h3, h4, p { font-family: helvetica, sans-serif;} 
p { line-height: 20pt;
    margin: 0 5em 6pt 0;
} 
--> 
</style>
</head>
<body>
<h3>annotated sample sessions</h3>

<p>this is a minimal tutorial, showing by example what you can do with
and expect from this library.  this text is directed to scripts
authors who want to be able to log the activity of their programs.</p>

<p>this library attempts to be as compatible as possible (that is: as
it was conceivable to the author) to the
standard <a href="http://docs.python.org/library/logging.html">Python
logging</a> library.  if you are accustomed to that logging library,
this one will look familiar to you.</p>

<h4>the basics</h4>

<p>in this session we work with one single logger, the root logger, and we use only console handlers</p>

<p>start up R, load the library, use the basic configuration.</p>
<code>
R> <user>library(logging)</user><br/>
R> <user>basicConfig()</user><br/>
R>
</code>

<p>let's check the effect of the above actions.  our loggers are
environments, so we can use for example <tt>ls</tt> and <tt>with</tt>
to inspect them.  after this basic configuration, our logger has
handlers and a level and it contains one handler.  this is enough for
some simple logging to the console.  the default logging level of the
root logger is <tt>INFO</tt> (20).  anything at level lower than <tt>INFO</tt> will not be
logged.</p>

<code>
R> <user>ls(getLogger())</user><br/>
[1] "handlers" "level"<br/>
R> <user>with(getLogger(), level)</user><br/>
INFO <br/>
&nbsp; 20 <br/>
R> <user>with(getLogger(), names(handlers))</user><br/>
[1] "basic.stdout"<br/>
R> <user>loginfo('does it work?')</user><br/>
2010-04-08 11:28:35 INFO::does it work?<br/>
R> <user>logwarn('%s %d', 'my name is', 5)</user><br/>
2010-04-08 11:28:48 WARN::my name is 5<br/>
R> <user>logdebug('I am a silent child')</user><br/>
R>
</code>

<p>we add an other handler to the console, without specifying its
name.  it gets one automatically from the name of the function.  you
can add and remove handlers using their names.  you can also refer to
them by function, if that is the way you defined it.</p>

<code>
R> <user>addHandler(writeToConsole)</user><br/>
R> <user>with(getLogger(), names(handlers))</user><br/>
[1] "basic.stdout"   "writeToConsole"<br/>
R> <user>loginfo('test')</user><br/>
2010-04-07 11:31:06 INFO::test<br/>
2010-04-07 11:31:06 INFO::test<br/>
R> <user>logwarn('test')</user><br/>
2010-04-07 11:31:15 WARN::test<br/>
2010-04-07 11:31:15 WARN::test<br/>
R> <user>removeHandler('writeToConsole')</user><br/>
R> <user>logwarn('test')</user><br/>
2010-04-07 11:32:37 WARN::test<br/>
R>
</code>

<p>handlers have a level associated to them.  any logging record
passing through a handler and having a level lower than the level of
the handler is ignored.  you can alter the level of a handler.  this
is what we do in the following lines: we alter the level of the
default console handler 'basic.stdout' to 30 (<tt>WARN</tt>).  by
the way, also handlers are environments.</p>

<code>
R> <user>addHandler(writeToConsole)</user><br/>
R> <user>setLevel(30, getHandler('basic.stdout'))</user><br/>
R> <user>loginfo('test')</user><br/>
R> <user>logwarn('test')</user><br/>
2010-04-07 15:17:40 WARN::test <br/>
R> <user>with(getHandler('basic.stdout'), level)</user><br/>
WARN <br/>
&nbsp; 30 <br/>
R> 
</code>

<h4>hierarchical loggers</h4>

<p>in the previous section we have worked -implicitly- with one
logger, the root logger.  we can refer to it explicitly: its name is
the empty string.  this also explains that "::" in the messages sent
to the console, between the first and the second ":" there's the name
of the logger that is associated to the log record shown.</p>

<code>
R> <user>with(getLogger(logger=''), names(handlers))</user><br/>
[1] "basic.stdout"<br/>
R> <user>with(getLogger('libro'), names(handlers))</user><br/>
NULL
</code>

<p>when issuing a logging record, you can specify to which logger you
want to send it.  loggers are created when first needed, so we can
just assume all loggers we need also exist.  the logger will offer it
to all its attached handlers and then pass it to its parent logger.
loggers are organized hierarchically, in a way that is similar to the
way directories are organized.  </p>

<p>just as directories contain files, loggers contain handlers and
their name is, within the logger, unique.  also similarly than to
directories, all loggers have one parent, except the root logger that
has none.  the name of the logger specifies the location of the logger
in this hierarchy.  an example will hopefully clarify.  </p>

<p>let's start from scratch, either a brand new R session or by
resetting the logging system.</p>

<code>
R> <user>logReset()</user><br/>
R> <user>addHandler(writeToConsole, logger='libro.romanzo')</user><br/>
R> <user>loginfo('chiarastella', logger='libro.romanzo.campanile')</user><br/>
2010-04-08 11:18:59 INFO:libro.romanzo.campanile:chiarastella<br/>
R> <user>loginfo('memories of a survivor', logger='libro.romanzo.lessing')</user><br/>
2010-04-08 11:22:06 INFO:libro.romanzo.lessing:memories of a survivor<br/>
R> <user>logwarn('talking to a upper level logger', logger='libro')</user><br/>
R> <user>logerror('talking to an unrelated logger', logger='rivista.cucina')</user><br/>
R> 
</code>

<p>notice that loggers are automatically defined by the simple action of
naming them.  what happened above is that the handler we created,
attached to the 'libro.romanzo' logger, only saw the records going to
the loggers below its logger.  all records going to upper level
loggers or to unrelated loggers are not logged, regardless of the
level.</p>

<p>also notice that the text printed doesn't contain any more that
"::".  between the two ":" there's the name of the logger that
received the logging record in the first place.</p>

<h4>logging to file</h4>

<B>TODO</B>
use the exported commodity function <tt>writeToFile</tt>.  you specify the name
of the file as an extra parameter <tt>file</tt> to the function <tt>addHandler</tt>.

<h4>formatting your log records</h4>

</body>
</html>
